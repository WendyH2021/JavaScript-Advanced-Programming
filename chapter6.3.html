<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>定型数组</title>
    </head>
    <body>
        <script type="text/javascript">
            // const buf = new ArrayBuffer(16);

            // // DataView 默认使用整个ArrayBuffer
            // const fullDataView = new DataView(buf);
            // alert(fullDataView.byteOffset);
            // alert(fullDataView.byteLength);
            // alert(fullDataView.buffer === buf);

            // // 构造函数接收一个可选的字节偏移量和字节长度
            // // byteOffset=0 表示视图从缓冲起点开始
            // // byteLength=8 限制视图为前8个字节
            // const firstHalfDataView = new DataView(buf, 0, 8);
            // alert(firstHalfDataView.byteOffset);
            // alert(firstHalfDataView.byteLength);
            // alert(firstHalfDataView.buffer === buf);

            // // 如果不指定，则DataView 会使用剩余的缓冲
            // // byteOffset=8 表示视图从缓冲的第9个字节开始
            // // byteLength 未指定，默认为剩余缓冲
            // const secondHalfDataView = new DataView(buf, 8);
            // alert(secondHalfDataView.byteOffset);
            // alert(secondHalfDataView.byteLength);
            // alert(secondHalfDataView.buffer === buf);

            // // 1. ElementType
            // // 在内存中分配两个字节并声明一个DataView
            // const buf = new ArrayBuffer(2);
            // const view = new DataView(buf);

            // // 说明整个缓冲确实所有二进制位都是0
            // // 检查第一个和第二个字符
            // alert(view.getInt8(0));
            // alert(view.getInt8(1));
            // // 检查整个缓冲
            // alert(view.getInt16(0));

            // // 将整个缓冲都设置为1
            // // 255的二进制表示是11111111(2^8-1)
            // view.setUint8(0, 255);

            // // DataView 会自动将数据转换为特定的ElementType
            // // 255的十六进制表示是 0xFF
            // view.setUint8(1, 0xFF);

            // // 现在，缓冲里都是1了
            // // 如果把它当成二补数的有符号整数，则应该是-1
            // alert(view.getInt16(0));

            // 2. 合并、复制和修改数组: set()
            // 创建长度为8的int16数组
            // const container = new Int16Array(8);
            // // 把定型数组复制为前4个值
            // // 偏移量默认为索引0
            // container.set(Int8Array.of(1, 2, 3, 4));
            // console.log(container);
            // // 把普通数组复制为后4个值
            // // 偏移量4表示从索引4开始插入
            // container.set([5, 6, 7, 8], 4);
            // console.log(container);

            // // 溢出会抛出错误
            // container.set([5, 6, 7, 8], 7);

            // subarray() 执行与 set()相反的操作
            const source = Int16Array.of(2, 4, 6, 8);

            // 把整个数组复制为一个同类型的新数组
            const fullCopy = source.subarray();
            console.log(fullCopy);

            // 从索引2开始复制数组
            const halfCopy = source.subarray(2);
            console.log(halfCopy);

            // 从索引1开始复制到索引3
            const partialCopy = source.subarray(1, 3);
            console.log(partialCopy);

            
        </script>
    </body>
</html>